# Web of Tomorrow

Source code to build the [Web of Tomorrow](http://www.weboftomorrow.com).  The
content and such is not within this repository.  The site is statically
generated by using [chill](https://github.com/jkenlooper/chill).  It uses
a build script to create the compiled/minified css and js.   


## Testing grounds

The website is rather simple and could just be a few static files without any
fancy templating and compiling involved.  But, that doesn't scale and I like to
practice using my tools for small things so I'm better prepared for larger
projects.  Some notable things I'm trying out:

* Testing a few ideas on structuring the site in a more modular approach.

* Experimenting with bundling all the tools used to generate the static
  resources.
  
* Using `npm version` when commiting the `dist/` files to the repository for
  tagged releases.

* Placing vendor CSS and JS in the lib directory, but in tag/gzipped packages.

## Installing the dependencies

It is necessary to have some tools installed in order to show a local version
of the website in a browser.  I use
[chill](https://github.com/jkenlooper/chill) which is a static website
generator.  To build the files in `dist/` involves a custom set of other tools
which can be installed by using [npm](https://www.npmjs.com/).

I have set git to ignore the `dist/` contents for the repository.  All the
`dist/*` files are only included when using `npm version` to make a tagged
release.  The `.gitattributes` file also tells git to treat these as binary
files when showing diffs and merging.  These resources are all generated by
running the npm run scripts shown in the `package.json`. I include the packed
versions of outside dependencies in `lib/`.  That way the dependencies for the
site are bundled and the files in `dist/` can be reproduced.

Within the directory where the package.json is run:

    npm install

The `package.json` devDependencies list a wot-builder package that is in
`lib/`.  I bundled my whole setup to build the `dist/` resources into this
package.  Note that `npm dedupe` is ran in the preinstall script.  I do this as
a workaround to get webpack and other tools to be available.

Now install [chill](https://github.com/jkenlooper/chill).  Chill is built on
the [Flask](http://flask.pocoo.org/) web framework.  I recommend using
[pip](https://pip.pypa.io/en/stable/) to install it.

    pip install chill

### Load the site with test content

To run the site locally with some test content (All content on the
[Web of Tomorrow](http://www.weboftomorrow.com) site is stored elsewhere):

    cat test-content/db.dump | sqlite3 test-content/db
    chill run --config test.cfg

And check it out at on your machine: http://localhost:5000/test/

## Developing

The site uses [webpack](https://webpack.github.io/) to create the static assets
that are then placed in `dist/`.  When actively developing the site it's best
to run the `npm run watch` command which will watch the src files for changes
and build them.  The alternative is to compile non-minified code with `npm run
debug`.


## Releasing

The `npm version` command is used to bump and tag versions. It also runs
commands to build the resources (See the scripts section in the package.json).
It also does some specific `chill` commands to create the static version of the
whole site and upload it to a rackspace cdn.

To release a new version and update the website (requires rackspace
credentials) follow the below workflow:

    npm version [major | minor | patch | ... ]


## Contributing

Yeah, if you see something that can be improved, then I'd be happy to merge it
in.  
